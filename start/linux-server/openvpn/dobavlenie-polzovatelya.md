---
order: 1
title: Добавление пользователя
---

## Подключение к серверу

Для настройки пользователя необходимо подключиться к серверу введите в своем теринале 

```bash
ssh admingp@192.168.100.74 
```

далее вводите `yes` и пароль `Iddqdidkfa!`

Как только вы подключились нужно подключиться к tmux сессии для этого введите команду 

```bash
tmux attach -s main
```

## Генерация ключей подключения

Чтобы пользователь мог безопасно и быстро подключаться нужно настроить ключи доступа для этого в левой панели вводим 

```bash
 sudo ./easyrsa build-client-full <ИмяПользователя> nopass < key_generation_input.txt 
```

далее нужно ввести `yes` и пароль от хранилища доверенных ключей `iddqdidkfa` 

после этого нужно создать папку клиента 

```bash
sudo mkdir /etc/openvpn/client/<ИмяПользователя>
```

копируем в нее ключи доступа

```bash
sudo cp -rp /etc/easy-rsa/pki/{ca.crt,issued/<ИмяПользователя>.crt,private/<ИмяПользователя>.key} /etc/openvpn/client/<ИмяПользователя>
```

## Создание конфига подключения

Чтобы создать конфиг копируем конфигурационный файл уже имеющего пользователя 

```bash
sudo cp /etc/openvpn/client/<ИмяПользователя1>/<ИмяПользователя1>.conf /etc/openvpn/client/<ИмяНовогоПользователя>/<ИмяНовогоПользователя>.conf
```

Далее открываем файл создаваемого пользователя в удобном вам реакторе, например vim или nano, и заменяем значения ключей на значения из папки пользователя openvpn.

**Заменять нужно только значения между** `-----BEGIN CERTIFICATE-----` **и** `-----END CERTIFICATE-----` **в тегах** `<ca></ca> <cert></cert> <key></key>`\
Чтобы посмотреть значения сертификатов в правой панели перейдите в директорию текущего пользователя *(чтобы перейди в правую панель нажмите* `CTRL+b` *а потом* `->`*, стрелочка вправо, соответственно для левой панели)* и введите команду 

```
cat <НазваниеСертификата>
```

Внутрь `<ca></ca>` нужно вставить значение `ca.crt`

Внутрь `<cert></cert>` нужно вставить значение `<ИмяПользователя>.crt`

Внутрь `<key></key>` нужно вставить значение `<ИмяПользователя>.key`

Далее копируете сохраняете конфигурацию и копируете ее в домашнюю директорию пользователя в левой панели и прописываете владельца как admingp

```bash
sudo cp  /etc/openvpn/client/<ИмяНовогоПользователя>/<ИмяНовогоПользователя>.conf ~/
sudo chown admingp:admingp ~/<ИмяНовогоПользователя>.conf
```

Чтобы скопировать себе конфиг на рабочий компьютер создайте еще одно окно терминала или отключитесь от сессии tmux (`CTRL+b`, d) и пропишите команду `exit` 

После этого введите команду 

```bash
scp admingp@192.168.100.74:/home/admingp/<ИмяНовогоПользователя>.conf ./
```

Как только команда отработает файл окажется в той директории из которой был запущен терминал (зачастую в домашней папке пользователя) 