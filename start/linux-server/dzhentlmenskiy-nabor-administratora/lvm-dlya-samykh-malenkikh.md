---
order: 3
title: LVM для самых маленьких
---

## Основные понятия

1. **PV (phisical volume) - Твой физический диск или его раздел**

   -  **Кто это:** Это твой настоящий жесткий диск (или его часть). Представь, что это просто кирпич. Обычный, скучный, но прочный. Ты можешь взять несколько кирпичей (несколько дисков или разделов) и сказать: "LVM, вот тебе материал для работы!".

2. **VG (Volume Group) -- Группа Томов**

   -  **Кто это:** Это большой ящик для игрушек, куда ты бросаешь все свои кирпичи (PV). Перегородки между кирпичами в этом ящике стираются. Получается одна большая куча места (`/dev/vg_name`). Это сердце LVM! Теперь у тебя есть не "Диск 1 на 250Гб и Диск 2 на 500Гб", а просто "куча свободного места на 750Гб".

3. **LV (Logical Volume) -- Логический Том**

   -  **Кто это:** А вот это уже готовые полочки и ящики, которые ты выдвигаешь из своего большого ящика (VG). Вот эта полочка (`/dev/vg_name/home`) под фотографии (100 Гб), вот этот ящик (`/dev/vg_name/root`) под систему (50 Гб). Система видит их как самые обычные диски и может использовать.

А теперь самое вкусное -- **зачем это всё?**

## Суперспособности LVM (Почему он крутой?)

1. **Творец пространства.** Заканчивается место на полке для фотографий (`/home`)? Старая система: паника, копирование данных, изменение разделов, молитвы. LVM: команда `lvextend`, и ты просто *добавляешь* место к своей полке из общего ящика (VG), не удаляя ни одной старой фотки!

2. **Укротитель дисков.** Ты можешь собрать свой общий ящик (VG) из кусочков разных дисков (даже SSD + HDD). Система будет видеть это как одно целое пространство. Добавил новый жесткий диск? Просто преврати его в кирпич (PV) и брось в общий ящик (VG), увеличив его размер.

3. **Машина времени (снимки).** Ты можешь сделать мгновенный "снимок" (snapshot) своей полки с системой (`/root`) прямо перед тем, как обновить ядро или поставить подозрительную программу. Если что-то пойдет не так, ты просто вернешь полку к тому виду, каким она была на момент снимка. Очень быстро и удобно!

## Как этим пользоваться? (Самое простое)

Собираем нашу конструкцию по шагам:

1. **Делаем кирпичи (PV):**

```bash
pvcreate /dev/sdb1 /dev/sdc1  # Говорим LVM: "Вот эти диски/разделы — твои кирпичи!"
```

1. **Собираем большой ящик (VG):**

```bash
vgcreate Moi_Dannye /dev/sdb1 /dev/sdc1  # Создаем ящик с именем "Moi_Dannye" из этих кирпичей
```

1. **Мастерим полки (LV):**

```bash
lvcreate -n home -L 100G Moi_Dannye  # В ящике "Moi_Dannye" мастерим полку "home" размером 100Гб
lvcreate -n root -L 50G Moi_Dannye   # ... и полку "root" на 50Гб
```

1. **Всё готово!** Осталось отформатировать полки в нужную файловую систему (например, ext4) и начать ими пользоваться:

```bash
mkfs.ext4 /dev/Moi_Dannye/home
mkfs.ext4 /dev/Moi_Dannye/root
mount /dev/Moi_Dannye/home /home
```

1. **Волшебство: увеличиваем полку, если место кончилось:**

```bash

lvextend -L +20G /dev/Moi_Dannye/home  # Добавили 20Гб к полке "home"
resize2fs /dev/Moi_Dannye/home         # Сказали файловой системе, что теперь места больше
```

Готово! Место добавлено без перезагрузок и потери данных.

## Для продвинутых пользователей

### Задача №1 "АААА! Закончилось место на жестком диске"

1. Без паники

2. Подключаемся на сервер, если там Linux с lvm

   1. Радуемся

   2. Подключаем дополнительный диск или просим админа подключить его

3. После выполнения всех операций заходим в терминал (да в это страшное место)

4. Создаем из подключенного диска `pv`

```bash
pvcreate /dev/sdXY /dev/sdXY # Вместо sdXY указываем обозначения ваших дисков
```

1. Далее добавляем его в `vg`

```bash
vgextend vg /dev/sdXY # vg это виртуальная группа заполнешегося lv
```

1. После этого расширяем ваш `lv`

```bash
lvextend -L +20G /dev/Moi_Dannye/home  # Добавили 20Гб к полке "home"
# если хотите добавить все доступное место
lvextend -l +100%FREE /dev/Moi_Dannye/home
resize2fs /dev/Moi_Dannye/home
```

Все поздравляю вы успешно раширили место на вашем логическом разделе, если что-то не получилось обратитесь к более опытному коллеге, но если он не знает, или занят, или не хочет ~~настучите на него начальству~~ идите в поисковую систему за поиском решения, там оно обязательно найдется